version: "3.8"

services:
  spherical-monitor:
    build: .
    container_name: spherical-monitor
    environment:
      - VIRT_W=5120
      - VIRT_H=2880
      # Two Xvfb displays:
      # - SOURCE (:0 by default) is the big desktop where apps run
      # - VIEW (:1 by default) is the small desktop shown via noVNC
      - SOURCE_DISPLAY_NUM=:0
      - VIEW_DISPLAY_NUM=:1
      - VIEW_W=1280
      - VIEW_H=720
      # spherical_monitor captures from SOURCE; override if you change SOURCE_DISPLAY_NUM
      - CAPTURE_DISPLAY=:0
      # If set, uses this equirectangular panorama image as X11 wallpaper (background).
      - PANORAMA_PATH=/assets/castle_anime_2.png
      # VNC/noVNC ports (noVNC stays exposed via 6080->NOVNC_PORT)
      - VNC_PORT=5900
      - NOVNC_PORT=6080
      # Security:
      # Set password to enable VNC authentication (recommended).
      # - VNC_PASSWORD=change-me
      # Restrict VNC server to localhost (websockify still works).
      - VNC_LOCALHOST_ONLY=1
      # Можно задать тут сразу окно:
      # - TARGET_WINDOW_NAME=Calculator
      # или
      # - TARGET_WINDOW_ID=0x4600007
    ports:
      - "6080:6080"
    volumes:
      - ./assets:/assets
